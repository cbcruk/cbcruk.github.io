---
tags: ['parallel', 'serial']
status: draft
ctime: 2025-03-05
mtime: 2025-03-05
---

```ts
type Task = (callback: (result: string) => void) => void
type TasksCallback = (results: string[]) => void

function getResultSet() {
  const resultSet = new Set<string>()

  return resultSet
}

function parallel(tasks: Task[], callback: TasksCallback) {
  const resultSet = getResultSet()

  tasks.forEach((task) => {
    task((result) => {
      resultSet.add(result)

      if (resultSet.size === tasks.length) {
        callback([...resultSet])
      }
    })
  })
}

function serial(tasks: Task[], callback: TasksCallback) {
  const resultSet = new Set<string>()

  let index = 0

  const recursive = (task: Task) => {
    task((result) => {
      index++

      resultSet.add(result)

      if (resultSet.size === tasks.length) {
        callback([...resultSet])
      } else {
        recursive(tasks[index])
      }
    })
  }

  recursive(tasks[index])
}

const fn1: Task = (callback) => {
  setTimeout(() => {
    console.log('fn1')
    callback('fn1')
  }, 3000)
}

const fn2: Task = (callback) => {
  setTimeout(() => {
    console.log('fn2')
    callback('fn2')
  }, 4000)
}

console.time()
serial([fn1, fn2], (results) => {
  console.log('serial', results)
  console.timeEnd()
})

console.time()
parallel([fn1, fn2], (results) => {
  console.log('parallel', results)
  console.timeEnd()
})
```
