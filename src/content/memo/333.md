---
tags: []
status: release
ctime: 2025-01-01
mtime: 2025-01-01
---

Google Auth 결과로 제공되는 토큰 값(예: ID Token)에는 다양한 클레임(Claims)이 포함됩니다. **`sub`**와 **`jti`**는 이 클레임 중 일부로, 각각 특정한 목적을 가지고 있습니다.

### 1. **`sub` (Subject)**

- **의미**: `sub`는 토큰의 **주체**(subject)를 나타냅니다.  
  이는 사용자에 대한 **고유 식별자**로, Google 계정과 연관된 고유 ID입니다.
- **특징**:
  - 특정 사용자에 대해 항상 동일하며, Google 계정을 식별할 수 있습니다.
  - 일반적으로 애플리케이션에서 사용자 정보를 연결하거나 데이터베이스의 사용자 항목과 매핑할 때 사용됩니다.
  - **예시 값**: `"1234567890"` (사용자를 고유하게 식별하는 숫자 문자열)

---

### 2. **`jti` (JWT ID)**

- **의미**: `jti`는 **JWT 토큰의 고유 식별자**입니다.  
  이 값은 토큰을 식별하기 위한 **유일한 값**으로, 동일한 토큰이 두 번 사용되지 않도록 보호하거나 토큰을 추적할 때 사용됩니다.
- **특징**:
  - 주로 보안 목적으로 사용됩니다.
  - 예를 들어, 서버에서 발급된 토큰이 한 번만 사용되도록 하거나 특정 토큰을 무효화(Blacklist)하기 위해 사용할 수 있습니다.
  - **예시 값**: `"a1b2c3d4e5f6g7h8"`

---

### 추가 참고: ID Token의 주요 클레임들

Google ID Token에서 일반적으로 볼 수 있는 클레임은 다음과 같습니다:

| 클레임           | 의미                                      |
| ---------------- | ----------------------------------------- |
| `iss`            | 토큰 발급자 (예: `"accounts.google.com"`) |
| `aud`            | 토큰의 대상 애플리케이션 (Client ID)      |
| `iat`            | 토큰 발급 시각 (Unix timestamp)           |
| `exp`            | 토큰 만료 시각 (Unix timestamp)           |
| `email`          | 사용자의 이메일 주소                      |
| `email_verified` | 이메일이 인증되었는지 여부                |

---

이 값들은 보안 및 사용자 식별을 목적으로 활용됩니다. 특히 **`sub`**는 사용자에 대한 주요 식별자로, **`jti`**는 토큰 자체의 무결성을 유지하거나 관리할 때 유용합니다.

---

네, Google의 **`sub`** 값은 사용자를 고유하게 식별하는 값이므로, **`user_id`**와 동일하게 사용할 수 있습니다. 다만, 이를 실질적으로 사용할 때 몇 가지 점을 고려해야 합니다:

---

### **1. `sub` 값을 `user_id`로 사용해도 되는 경우**

- **사용자의 고유성을 보장**:  
  `sub` 값은 Google 계정에서 생성된 고유한 값으로, 동일한 사용자를 항상 일관되게 식별합니다. 따라서 별도의 `user_id`를 생성하지 않아도 사용자를 구분할 수 있습니다.
- **구현 단순화**:  
  Google 계정을 사용하는 로그인 시스템에서 굳이 추가적인 사용자 ID를 생성할 필요 없이, `sub` 값을 바로 사용하면 로직을 단순화할 수 있습니다.

- **일반적인 사용 사례**:
  - 사용자가 Google 로그인을 통해 앱을 처음 사용하는 경우, `sub` 값을 데이터베이스의 primary key 또는 사용자 ID로 저장.
  - 나중에 이 값을 통해 사용자를 식별.

---

### **2. 고려해야 할 점**

1. **Google 계정에 종속적**:

   - `sub` 값은 Google 계정과 연관된 값이기 때문에, 사용자가 다른 소셜 로그인(예: Facebook, Apple 등)을 사용하거나 일반 이메일/비밀번호로 계정을 생성하는 경우에는 통합된 ID 관리가 어려울 수 있습니다.
   - 여러 로그인 방식을 제공할 계획이라면, `sub` 값을 내부적으로 관리할 `user_id`에 매핑하여 저장하는 것이 유리합니다.

2. **외부 계정 변경 가능성**:

   - 사용자가 Google 계정을 삭제하고 새로운 Google 계정으로 다시 로그인하면 새로운 `sub` 값이 할당됩니다. 이 경우 사용자의 기존 데이터와 연결이 끊어질 수 있습니다.

3. **데이터베이스 설계**:
   - **`sub` 값은 문자열**입니다. 따라서 데이터베이스에서 이를 primary key로 사용할 경우, 문자열 기반의 키 설계와 인덱싱 성능을 고려해야 합니다.

---

### **3. 권장 방안**

- **단일 로그인 방식(Google 로그인만 지원)**:

  - `sub`를 `user_id`로 직접 사용해도 무방합니다. 예를 들어:
    ```json
    {
      "user_id": "1234567890",
      "email": "user@example.com",
      "name": "John Doe"
    }
    ```

- **여러 로그인 방식을 지원하거나 확장 가능성을 고려**:
  - 별도의 `user_id`를 생성하고, `sub` 값을 이를 보조하는 외부 식별자로 저장합니다.
    ```json
    {
      "user_id": "abc123",
      "google_sub": "1234567890",
      "email": "user@example.com",
      "name": "John Doe"
    }
    ```

이 방식은 Google 외에도 Facebook, Apple 등 다양한 외부 인증 제공자와의 통합을 지원하는 확장 가능한 구조를 제공합니다.

---

### **결론**

Google 로그인을 유일한 인증 방식으로 사용할 계획이라면 **`sub` 값을 `user_id`로 사용하는 것**은 문제없습니다. 하지만 이후 확장 가능성이나 다른 인증 제공자와의 통합 가능성을 고려한다면 **별도의 `user_id`를 생성하고, `sub`를 외부 식별자로 사용하는 방안**이 더 유연합니다.
